jQuery(document).ready(function(f){var c,a={};if(!f('input[name="_soliloquy_settings[type]"]').is(":checked")){f("#soliloquy-default-slider").attr("checked","checked")}if("default"==f('input[name="_soliloquy_settings[type]"]:checked').val()){f(".soliloquy-upload-text, #soliloquy-upload, #soliloquy-images").show();f("#soliloquy-upload").css("display","inline-block")}else{f(".soliloquy-upload-text, #soliloquy-upload, #soliloquy-images").hide()}f('input[name="_soliloquy_settings[type]"]').on("change",function(){if("default"==f(this).val()){f(".soliloquy-upload-text, #soliloquy-upload, #soliloquy-images").fadeIn();f("#soliloquy-upload").css("display","inline-block")}else{f(".soliloquy-upload-text, #soliloquy-upload, #soliloquy-images").hide()}});f(".soliloquy-image-meta").hide();if(f("#soliloquy-advanced").is(":checked")){f("#soliloquy-navigation-box, #soliloquy-control-box, #soliloquy-keyboard-box, #soliloquy-multi-keyboard-box, #soliloquy-mousewheel-box, #soliloquy-pauseplay-box, #soliloquy-random-box, #soliloquy-number-box, #soliloquy-control-box, #soliloquy-loop-box, #soliloquy-action-box, #soliloquy-hover-box, #soliloquy-slider-css-box, #soliloquy-reverse-box, #soliloquy-smooth-box, #soliloquy-touch-box, #soliloquy-delay-box, .soliloquy-advanced").show()}else{f("#soliloquy-navigation-box, #soliloquy-control-box, #soliloquy-keyboard-box, #soliloquy-multi-keyboard-box, #soliloquy-mousewheel-box, #soliloquy-pauseplay-box, #soliloquy-random-box, #soliloquy-number-box, #soliloquy-control-box, #soliloquy-loop-box, #soliloquy-action-box, #soliloquy-hover-box, #soliloquy-slider-css-box, #soliloquy-reverse-box, #soliloquy-smooth-box, #soliloquy-touch-box, #soliloquy-delay-box, .soliloquy-advanced").hide()}if(0==f("#soliloquy-width").val().length){f("#soliloquy-width").val(soliloquy.width)}if(0==f("#soliloquy-height").val().length){f("#soliloquy-height").val(soliloquy.height)}if("custom"!==f("#soliloquy-default-size option[selected]").val()){f("#soliloquy-custom-sizes").hide()}else{f("#soliloquy-default-sizes").hide()}if(0==f("#soliloquy-speed").val().length){f("#soliloquy-speed").val(soliloquy.speed)}if(0==f("#soliloquy-duration").val().length){f("#soliloquy-duration").val(soliloquy.duration)}f("#soliloquy-default-size").on("change",function(){if("default"!==f(this).val()){f("#soliloquy-default-sizes").hide();f("#soliloquy-custom-sizes").fadeIn("normal")}else{f("#soliloquy-custom-sizes").hide();f("#soliloquy-default-sizes").fadeIn("normal")}});f("#soliloquy-advanced").on("change",function(){if(f(this).is(":checked")){f("#soliloquy-navigation-box, #soliloquy-control-box, #soliloquy-keyboard-box, #soliloquy-multi-keyboard-box, #soliloquy-mousewheel-box, #soliloquy-pauseplay-box, #soliloquy-random-box, #soliloquy-number-box, #soliloquy-control-box, #soliloquy-loop-box, #soliloquy-action-box, #soliloquy-hover-box, #soliloquy-slider-css-box, #soliloquy-reverse-box, #soliloquy-smooth-box, #soliloquy-touch-box, #soliloquy-delay-box, .soliloquy-advanced").fadeIn("normal")}else{f("#soliloquy-navigation-box, #soliloquy-control-box, #soliloquy-keyboard-box, #soliloquy-multi-keyboard-box, #soliloquy-mousewheel-box, #soliloquy-pauseplay-box, #soliloquy-random-box, #soliloquy-number-box, #soliloquy-control-box, #soliloquy-loop-box, #soliloquy-action-box, #soliloquy-hover-box, #soliloquy-slider-css-box, #soliloquy-reverse-box, #soliloquy-smooth-box, #soliloquy-touch-box, #soliloquy-delay-box, .soliloquy-advanced").fadeOut("normal")}});f(".soliloquy-size-more").on("click.soliloquySizeExplain",function(k){k.preventDefault();f("#soliloquy-explain-size").fadeToggle()});f("#soliloquy-area").on("click.soliloquyRemove",".remove-image",function(l){l.preventDefault();var o=confirm(soliloquy.delete_nag);if(!o){return}var n=f(this).parent().attr("data-full-delete"),m=(typeof n!=="undefined"&&n!==false)?true:false;c=f(this).parent().attr("id");f("#soliloquy-upload").after('<span class="soliloquy-waiting"><img class="soliloquy-spinner" src="'+soliloquy.spinner+'" width="16px" height="16px" style="margin: -1px 5px 0; vertical-align: middle;" />'+soliloquy.removing+"</span>");var k={action:"soliloquy_remove_images",attachment_id:c,do_delete:m?true:false,nonce:soliloquy.removenonce};f.post(soliloquy.ajaxurl,k,function(p){f("#"+c).fadeOut("normal",function(){f(this).remove();f(".soliloquy-waiting").fadeOut("normal",function(){f(this).remove();f(".soliloquy-load-library").attr("data-soliloquy-offset",0).addClass("has-search").trigger("click")})})},"json")});f("#soliloquy-area").on("click.soliloquyModify",".modify-image",function(n){n.preventDefault();var l=f(this).parent().attr("id"),k="meta-"+l;f("#"+k).appendTo("body").show();f.each(a,function(){this.refresh()});var m=function(o){o.preventDefault();f("#"+k).appendTo("#"+l).hide()};f(document).on("click.soliloquyIframe",".media-modal-close, .media-modal-backdrop",m);f(document).on("keydown.soliloquyIframe",function(o){if(27==o.keyCode){m(o)}})});f(document).on("click.soliloquyMeta",".soliloquy-meta-submit",function(p){p.preventDefault();var n=f(this).parent().parent().parent().prev().find(".soliloquy-meta-table").attr("id");var k=f(this).parent().parent().parent().prev().find(".soliloquy-meta-table").attr("data-attachment-id");var r=f(this).text();var m=f(this);var l=f(this).parent().parent().parent().prev().find(".soliloquy-meta-table").attr("data-slide-type");var q=false;m.text(soliloquy.saving);if("video"==l){q=f("#meta-"+k).find(".soliloquy-video-title").val()}if("html"==l){q=f("#meta-"+k).find(".soliloquy-html-title").val()}var o={action:"soliloquy_update_meta",attach:k,id:soliloquy.id,type:l,nonce:soliloquy.metanonce};f("#"+n+" td").each(function(){var s=f(this).find("*");f.each(s,function(){var t=f(this).attr("class");if(t){t=t.replace(" ","-")}var u=f(this).val();if("checkbox"==f(this).attr("type")){var u=f(this).is(":checked")?"true":"false"}if("radio"==f(this).attr("type")){if(!f(this).is(":checked")){return}var u=f(this).val()}o[t]=u})});f.post(soliloquy.ajaxurl,o,function(s){m.text(soliloquy.saved);if(q){f("#"+k).find("h4").text(q)}setTimeout(function(){f("#meta-"+k).hide().appendTo("#"+k);m.text(r)},500)},"json")});f("#soliloquy-area").on("click.soliloquyUpload","#soliloquy-upload",function(m){m.preventDefault();var k=true;f("#soliloquy-upload-ui").appendTo("body").show();var l=function(n){n.preventDefault();f("#soliloquy-upload-ui").appendTo("#soliloquy-upload-ui-wrapper").hide();b();k=false};f(document).on("click.soliloquyIframe","#soliloquy-upload-ui .media-modal-close, #soliloquy-upload-ui .media-modal-backdrop",l);f(document).on("keydown.soliloquyIframe",function(n){if(27==n.keyCode&&k){l(n)}})});f(".soliloquy-media-frame .media-menu-item").on("click",function(n){n.preventDefault();var m=f(this),k=m.parent().find(".active").removeClass("active").data("soliloquy-content"),l=m.addClass("active").data("soliloquy-content");f("#"+k).hide();f("#"+l).show();if("soliloquy-html-slides"==l){f.each(a,function(){this.refresh()})}});f(".soliloquy-gallery").on("click",".thumbnail, .check, .media-modal-icon",function(k){k.preventDefault();if(f(this).parent().parent().hasClass("soliloquy-in-slider")){return}if(f(this).parent().parent().hasClass("selected")){f(this).parent().parent().removeClass("details selected")}else{f(this).parent().parent().addClass("details selected")}});f(".soliloquy-load-library").on("click",function(m){m.preventDefault();var l=f(this);l.after('<span class="soliloquy-waiting" style="display: inline-block; margin-top: 16px;"><img class="soliloquy-spinner" src="'+soliloquy.spinner+'" width="16px" height="16px" style="margin: -1px 5px 0; vertical-align: middle;" />'+soliloquy.loading+"</span>");var k={action:"soliloquy_load_library",offset:parseInt(l.attr("data-soliloquy-offset")),post_id:soliloquy.id,nonce:soliloquy.loadnonce};f.post(soliloquy.ajaxurl,k,function(n){l.attr("data-soliloquy-offset",parseInt(l.attr("data-soliloquy-offset"))+20);if(n&&n.html&&l.hasClass("has-search")){f(".soliloquy-gallery").html(n.html);l.removeClass("has-search")}else{f(".soliloquy-gallery").append(n.html)}f(".soliloquy-waiting").fadeOut("normal",function(){f(this).remove()})},"json")});f(".soliloquy-html").find(".soliloquy-html-code").each(function(k,l){var m=f(l).attr("id");a[m]=CodeMirror.fromTextArea(l,{enterMode:"keep",indentUnit:4,electricChars:false,lineNumbers:true,lineWrapping:true,matchBrackets:true,mode:"php",smartIndent:false,tabMode:"shift",theme:"eclipse"});a[m].on("blur",function(n){f("#"+m).text(n.getValue())});a[m].refresh()});f(".soliloquy-add-html-slide").on("click",function(l){l.preventDefault();var k=parseInt(f(this).attr("data-soliloquy-html-number")),m="soliloquy-html-slide-"+f(this).attr("data-soliloquy-html-number");f(this).attr("data-soliloquy-html-number",k+1).parent().before(i(k));a[m]=CodeMirror.fromTextArea(document.getElementById(m),{enterMode:"keep",indentUnit:4,electricChars:false,lineNumbers:true,lineWrapping:true,matchBrackets:true,mode:"php",smartIndent:false,tabMode:"shift",theme:"eclipse"});a[m].on("blur",function(n){f("#"+m).text(n.getValue())});a[m].refresh()});function i(l){var k="";k+='<div class="soliloquy-html-slide-holder"><p class="no-margin-top"><a href="#" class="button button-secondary soliloquy-delete-html-slide" title="'+soliloquy.htmlremove+'">'+soliloquy.htmlremove+'</a><label for="soliloquy-html-slide-'+l+'-title"><strong>'+soliloquy.htmlslide+'</strong></label><br /><input type="text" class="soliloquy-html-slide-title" id="soliloquy-html-slide-'+l+'-title" value="" placeholder="'+soliloquy.htmlplace+'" /></p><textarea class="soliloquy-html-slide-code" id="soliloquy-html-slide-'+l+'">'+soliloquy.htmlstart+"</textarea></div>";return k}f("#soliloquy-html-slides").on("click",".soliloquy-delete-html-slide",function(k){k.preventDefault();f(this).parent().parent().remove()});f(".soliloquy-add-video-slide").on("click",function(l){l.preventDefault();var k=parseInt(f(this).attr("data-soliloquy-video-number")),m="soliloquy-video-slide-"+f(this).attr("data-soliloquy-html-number");f(this).attr("data-soliloquy-video-number",k+1).parent().before(d(k))});function d(l){var k="";k+='<div class="soliloquy-video-slide-holder"><p class="no-margin-top"><a href="#" class="button button-secondary soliloquy-delete-video-slide" title="'+soliloquy.htmlremove+'">'+soliloquy.htmlremove+'</a><label for="soliloquy-video-slide-'+l+'-title"><strong>'+soliloquy.videoslide+'</strong></label><br /><input type="text" class="soliloquy-video-slide-title" id="soliloquy-video-slide-'+l+'-title" value="" placeholder="'+soliloquy.videoplace+'" /></p><p><label for="soliloquy-video-slide-'+l+'"><strong>'+soliloquy.videotitle+'</strong></label><br /><input type="text" class="soliloquy-video-slide-url" id="soliloquy-video-slide-'+l+'" value="" placeholder="'+soliloquy.videooutput+'" /></p><p class="no-margin-bottom"><label for="soliloquy-video-slide-'+l+'-caption"><strong>'+soliloquy.videocaption+'</strong></label><br /><textarea class="soliloquy-video-slide-caption" id="soliloquy-video-slide-'+l+'-caption"></textarea></p></div>';return k}f("#soliloquy-video-slides").on("click",".soliloquy-delete-video-slide",function(k){k.preventDefault();f(this).parent().parent().remove()});f(document).on("click",".soliloquy-media-insert",function(q){q.preventDefault();var p=f(this),r=f(this).text(),n={action:"soliloquy_insert_slides",nonce:soliloquy.insertnonce,post_id:soliloquy.id,data:{selected:{},video:{},html:{}}},l=false,m=false,k=false;p.text(soliloquy.inserting);var o=function(){f("#soliloquy-upload-ui").appendTo("#soliloquy-upload-ui-wrapper").hide();b();main_frame=false};f(".soliloquy-media-frame").find(".attachment.selected:not(.soliloquy-in-slider)").each(function(s,t){n.data.selected[s]=f(t).attr("data-attachment-id");l=true});f(".soliloquy-media-frame").find(".soliloquy-video-slide-holder").each(function(s,t){n.data.video[s]={title:f(t).find(".soliloquy-video-slide-title").val(),url:f(t).find(".soliloquy-video-slide-url").val(),caption:f(t).find(".soliloquy-video-slide-caption").val()};m=true});f(".soliloquy-media-frame").find(".soliloquy-html-slide-holder").each(function(s,t){n.data.html[s]={title:f(t).find(".soliloquy-html-slide-title").val(),code:f(t).find(".soliloquy-html-slide-code").val()};k=true});f.post(soliloquy.ajaxurl,n,function(s){p.text(soliloquy.inserted);setTimeout(function(){o();p.text(r);if(l){f(".soliloquy-load-library").attr("data-soliloquy-offset",0).addClass("has-search").trigger("click")}if(m){f("#soliloquy-video-slides").find(".soliloquy-delete-video-slide").each(function(){f(this).trigger("click")})}if(k){f("#soliloquy-html-slides").find(".soliloquy-delete-html-slide").each(function(){f(this).trigger("click")})}},500)},"json")});f(document).on("keyup.soliloquySearchLibrary keydown.soliloquySearchLibrary","#soliloquy-gallery-search",function(){var l=f(this);f(".soliloquy-waiting").remove();l.before('<span class="soliloquy-waiting" style="display: inline-block; margin-top: 16px; margin-right: 10px;"><img class="soliloquy-spinner" src="'+soliloquy.spinner+'" width="16px" height="16px" style="margin: -1px 5px 0; vertical-align: middle;" />'+soliloquy.searching+"</span>");var m=f(this).val();var k={action:"soliloquy_library_search",nonce:soliloquy.librarysearch,post_id:soliloquy.id,search:m};g(function(){f.post(soliloquy.ajaxurl,k,function(n){f(".soliloquy-load-library").addClass("has-search").attr("data-soliloquy-offset",parseInt(0));if(n){f(".soliloquy-gallery").html(n.html)}f(".soliloquy-waiting").fadeOut("normal",function(){f(this).remove()})},"json")},"500")});var h=f("#soliloquy-images");h.sortable({containment:"#soliloquy-area",update:function(l,m){f(".soliloquy-waiting").show();var k={url:soliloquy.ajaxurl,type:"post",async:true,cache:false,dataType:"json",data:{action:"soliloquy_sort_images",order:h.sortable("toArray").toString(),post_id:soliloquy.id,nonce:soliloquy.sortnonce},success:function(n){f(".soliloquy-waiting").hide();return},error:function(o,p,n){f(".soliloquy-waiting").hide();return}};f.ajax(k)}});function b(){var k={action:"soliloquy_refresh_images",id:soliloquy.id,nonce:soliloquy.nonce};f(".soliloquy-waiting").remove();f("#soliloquy-upload").after('<span class="soliloquy-waiting"><img class="soliloquy-spinner" src="'+soliloquy.spinner+'" width="16px" height="16px" style="margin: -1px 5px 0; vertical-align: middle;" />'+soliloquy.loading+"</span>");f.post(soliloquy.ajaxurl,k,function(l){f("#soliloquy-images").html(l.images);f(".soliloquy-image-meta").hide();f(".soliloquy-image").find(".wp-editor-area").each(function(m,n){var o=f(n).attr("id").split("-")[2];quicktags({id:"soliloquy-caption-"+o,buttons:"strong,em,link,block,del,ins,img,ul,ol,li,code,close"});QTags._buttonsInit()});f(".soliloquy-html").find(".soliloquy-html-code").each(function(m,n){var o=f(n).attr("id");a[o]=CodeMirror.fromTextArea(n,{enterMode:"keep",indentUnit:4,electricChars:false,lineNumbers:true,lineWrapping:true,matchBrackets:true,mode:"php",smartIndent:false,tabMode:"shift",theme:"eclipse"});a[o].on("blur",function(p){f("#"+o).text(p.getValue())});a[o].refresh()})},"json");f(".soliloquy-waiting").fadeOut("normal",function(){f(this).remove()})}var g=(function(){var k=0;return function(m,l){clearTimeout(k);k=setTimeout(m,l)}})();f(document).on("click.soliloquyInternalLinking","#soliloquy-link-existing",function(l){l.preventDefault();var k=f(this);f(this).toggleClass("needs-close");f(this).next().fadeToggle("normal",function(){if(k.hasClass("needs-close")){k.text(soliloquy.linkclose)}else{k.text(soliloquy.linkopen)}})});f(document).on("keyup.soliloquySearchLinks keydown.soliloquySearchLinks",".soliloquy-search",function(){var n=f(this).attr("id");var m=f(this).val();var l=f(this).next().find("ul").attr("id");var k={action:"soliloquy_link_search",id:soliloquy.id,nonce:soliloquy.linknonce,search:m};g(function(){j(n,l,k)},"500")});f(document).on("click.soliloquyInsertLink",".soliloquy-results-list li",function(){if(f(this).hasClass("soliloquy-no-results")){return}f(".soliloquy-results-list li").removeClass("selected");f(this).addClass("selected");var n=f(this).find("input").val();var k=f(this).find(".soliloquy-item-title").text();var l=f(this).parent().parent().parent().parent().parent().find(".soliloquy-link").attr("id");var m=f(this).parent().parent().parent().parent().parent().find(".soliloquy-link-title").attr("id");f("#"+l).val(n);f("#"+m).val(k)});function j(m,l,k){f("#"+m).after('<span class="soliloquy-waiting"><img class="soliloquy-spinner" src="'+soliloquy.spinner+'" width="16px" height="16px" style="margin: -1px 5px 0; vertical-align: middle;" />'+soliloquy.searching+"</span>");f.post(soliloquy.ajaxurl,k,function(o){f("#"+l).children().remove();if(!o.links){var n='<li class="soliloquy-no-results"><span>'+soliloquy.noresults+"</span></li>";f("#"+l).append(n)}f.each(o.links,function(r,q){var s=o.links[r];var t=(r%2==0)?"even":"odd";var p='<li id="link-id-'+s.ID+'" class="soliloquy-result '+t+'"><input type="hidden" class="soliloquy-item-permalink" value="'+s.permalink+'" /><span class="soliloquy-item-title">'+s.title+'</span><span class="soliloquy-item-info">'+s.info+"</span></li>";f("#"+l).append(p)});var n=""},"json");f(".soliloquy-waiting").fadeOut("normal",function(){f(this).remove()})}function e(){}});